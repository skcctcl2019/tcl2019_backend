<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">

  <link rel="stylesheet" href="../../lib/jui/css/ui.min.css" />
  <link id="ui_theme" rel="stylesheet" href="../../lib/jui/css/ui-jennifer.min.css" />
  <link rel="stylesheet" href="../../lib/jui/css/grid.min.css" />
  <link id="grid_theme" rel="stylesheet" href="../../lib/jui/css/grid-jennifer.min.css" />
  <script src="../../lib/jquery-1.8.0.min.js"></script>
  <script src="../../lib/jui/js/core.min.js"></script>
  <script src="../../lib/jui/js/ui.min.js"></script>
  <script src="../../lib/jui/js/grid.min.js"></script>
  <script src="../../lib/jui/js/chart.min.js"></script>
  <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="../../gallery/admintool/index.css" rel="stylesheet" type="text/css" />
  <link id="index_theme" href="../../gallery/admintool/index-jennifer.css" rel="stylesheet" type="text/css" />
  <style>
    h3 {
      text-align: left;
      margin-left: 20px;
    }

    tr.border_bottom td {
      border-bottom: 0.1pt solid rgba(184, 184, 184, 0.849);
    }

    tr.border_bottom th {
      border-bottom: 0.1pt solid rgba(184, 184, 184, 0.849);
    }
  </style>
</head>

<body class="jui">

  <div class="header">
    <div class="logo">
      <i class="icon-menu"></i>
    </div>
    <div class="toolbar">
      <span>Theme</span>
      <span>
        <select onchange="changeTheme(this.value)">
          <option value="jennifer">Jennifer</option>
          <option value="dark">Dark</option>
        </select>
      </span>
      <span style="float:right" onclick="closePop()">
        Close
        <i class="icon-check"></i>
      </span>
    </div>
  </div>
  <div class="container">
    <div class="menu">
      <div class="vmenu ">
        <a href="./pop_1.html">
          <i class="icon-more"></i>사전 정보<BR>등록</a>
        <a href="./pop_2.html">
          <i class="icon-bell"></i> 긴급 실종<br>신고</a>
        <a href="./pop_3.html" class="active">
          <i class="icon-profile"></i>경찰청 DB<br>조회</a>
        <a href="./pop_4.html">
          <i class="icon-search"></i> 실종/보호<br>아동조회</a>
        <a href="./pop_5.html">
          <i class="icon-add-dir"></i>실종/보호<br>아동등록</a>
        <a href="./pop_6.html">
          <i class="icon-unhappy"></i>Market</a>
        <a href="./pop_7.html">
          <i class="icon-user"></i> My Page</a>
        <a href="./pop_8.html">
          <i class="icon-gear"></i> Admin </a>
      </div>
    </div>
    <div class="content">
      <div class="content-list">
        <div class="dashboard-first">
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Today's visitors</div>
              <div class="value">3,352</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Total registration</div>
              <div class="value" id="totRegChain" name="totRegChain">364,806</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Current Issued Token</div>
              <div class="value" id="totToken" name="totToken">15,610</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Your Token</div>
              <div class="value" id="yourToken" name="yourToken">1,250</div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="body">
            <h2 class="title" align='center' style="margin-left:0px; font-size:35px;margin-bottom:0px;margin-top:25px;">
              <img src="./icons/search1.png" style="height:35px"> 경찰청 DB 조회</h2>
          </div>
        </div>

        <section style="background-color:white">
          <div class="body" align="center">
            <p>
              <b style="font-size:15px">경찰청 DB에 보유한 정보를 조회할 수 있습니다.</b>
            </p>

            <TABLE class="table_search2 margin_t8 float_l" style="WIDTH: 613px" summary="대상,성별,이름,발생일,당시나이,신체특징,발생장소 검색"
              sizcache="5" sizset="98">
              <COLGROUP>
                <COL width="14%">
                <COL width="36%">
                <COL width="14%">
                <COL width="36%">
              </COLGROUP>
              <TBODY sizcache="5" sizset="98">
                <TR>
                <TR>
                  <TH>대상</TH>
                  <TD class=ls1 colSpan=3>
                    <INPUT id="writngTrgetDscds010" name="writngTrgetDscds" class="target" type="checkbox" value="010" checked="checked">
                    <LABEL for="writngTrgetDscds010">정상아동(18세미만)</LABEL>
                    <INPUT id="writngTrgetDscds020" name="writngTrgetDscds" class="target" type="checkbox" value="020" checked="checked">
                    <LABEL for="writngTrgetDscds020">가출인</LABEL>
                    <INPUT id="writngTrgetDscds040" name="writngTrgetDscds" class="target" type="checkbox" value="020" checked="checked">
                    <LABEL for="writngTrgetDscds040">시설보호무연고자</LABEL>
                    <br />
                    <INPUT id="writngTrgetDscds060" name="writngTrgetDscds" class="target" type="checkbox" value="060" checked="checked">
                    <LABEL for="writngTrgetDscds060">지적장애인</LABEL>
                    <INPUT id="writngTrgetDscds070" name="writngTrgetDscds" class="target" type="checkbox" value="070" checked="checked">
                    <LABEL for="writngTrgetDscds070">치매질환자</LABEL>
                    <INPUT id="writngTrgetDscds080" name="writngTrgetDscds" class="target" type="checkbox" value="080" checked="checked">
                    <LABEL for="writngTrgetDscds080">기타</LABEL>
                  </TD>
                </TR>
                <TR>
                  <TH>성별</TH>
                  <TD>
                    <INPUT id="sexdstnDscd0" name="sexdstnDscd" type="radio" value="0" checked="checked">
                    <LABEL for="sexdstnDscd0">전체</LABEL>
                    <INPUT id="sexdstnDscd1" name="sexdstnDscd" type="radio" value="1">
                    <LABEL for="sexdstnDscd1">남자</LABEL>
                    <INPUT id="sexdstnDscd2" name="sexdstnDscd" type="radio" value="2">
                    <LABEL for="sexdstnDscd2">여자</LABEL>
                  </TD>
                  <TH>이름</TH>
                  <TD>
                    <INPUT id="nm" name="nm" title="이름 입력" class="inputBox middle" style="WIDTH: 84px">
                  </TD>
                </TR>
                <TR sizcache="5" sizset="98">
                  <TH>발생일</TH>
                  <TD sizcache="5" sizset="98">
                    <INPUT id="detailDate1" name="detailDate1" value="1970-01-01" title="발생 시작일" class="inputBox middle" style="WIDTH: 68px" maxLength=10>
                    <A title=달력보기(새창) href="javascript:fn_egov_NormalCalendar(document.lcmMssVO, document.lcmMssVO.detailDate1);">
                      <IMG class=middle alt=달력보기 src="http://www.safe182.go.kr/static/home/images/common/icon/ic_calendar.gif">
                    </A> ~
                    <INPUT id="detailDate2" name="detailDate2" value="2020-12-31" title="발생 종료일" class="inputBox middle" style="WIDTH: 68px" maxLength=10>
                    <A title=달력보기(새창) href="javascript:fn_egov_NormalCalendar(document.lcmMssVO, document.lcmMssVO.detailDate2);">
                      <IMG class=middle alt=달력보기 src="http://www.safe182.go.kr/static/home/images/common/icon/ic_calendar.gif">
                    </A>
                  </TD>
                  <TH>
                    당시나이
                  </TH>
                  <TD>
                    <INPUT id="age1" name="age1" title="당시나이 시작" class="inputBox middle" style="WIDTH: 17px" maxLength=3 onKeyup="this.value=this.value.replace(/[^0-9]/g,'');"> 세~
                    <INPUT id="age2" name="age2" title="당시나이 끝" class="inputBox middle" style="WIDTH: 17px" maxLength=3 onKeyup="this.value=this.value.replace(/[^0-9]/g,'');"> 세 </TD>
                </TR>
                <TR>
                  <TH>특이사항</TH>
                  <TD>
                    <INPUT id="etcSpfeatr" name="etcSpfeatr" title="신체특징 입력" class="inputBox middle" style="WIDTH: 188px">
                  </TD>
                  <TH>발생장소</TH>
                  <TD>
                    <INPUT id="occrAdres" name="occrAdres" title="발생장소 입력" class="inputBox middle" style="WIDTH: 188px" >
                  </TD>
                </TR>
                <TR>
                  <TD class="colorBlue4 padNone" colSpan=2>
                    <P class=padding_l23>ex) "점이 있다", "허리가 굽었다" 등의 자연어로 검색 가능합니다.</P>
                  </TD>
                  <TD class="colorBlue4 padNone" colSpan=2>
                    <P class=padding_l23>ex) 서울시 용산구 갈월동 놀이터앞 등 상세주소로 검색해주세요.</P>
                  </TD>
                </TR>
                <TR>
                  <TH>이미지 선택</TH>
                  <TD class=ls1 colSpan=3>
                    <input type="file" style="font-size:15px" /> </TD>
                </TR>
                <TR>
                  <TD align="right" colspan="2">
                    <button class="btn focus" id="btn_inq">조회</button>
                  </TD>
                </TR>
              </TBODY>
            </TABLE>
        </section>
        <div style="background-color:white"><br><br></div>
        <!-- <table class="table classic hover">
          <thead>
            <tr>
              <th style="text-align:center">이름</th>
              <th style="text-align:center">사진</th>
              <th style="text-align:center">나이</th>
              <th style="text-align:center">연락처</th>
              <th style="text-align:center">특이사항</th>
            </tr>
          </thead>
          <tbody>
            <tr>
              <td>김재롱</td>
              <td>
                <img src="dog.jpg" alt="절미 얼굴 사진">
              </td>
              <td>8세</td>
              <td>010-777-8888</td>
              <td>
                왼쪽 눈 아래 점이 있어용<br><br>
                <button class="btn small focus" onclick="alert('details')">상세</button>
              </td>
            </tr>
          </tbody>
        </table> -->
        <div id="list_table"></div>
      </div>
    </div>
  </div>
  </div>
  <script>

      // onLoad의 역할
    $(function() {

        // getBabiesCount 를 호출하고, 해당 결과를 화면에 갱신
        $.ajax({
          url: '/getBabiesCount',
          type: 'GET'
        }).done(function (data) {

          $("#totRegChain").text(data);
        });

        // getTotalSupply router를 호출하고, 해당 결과를 화면에 갱신
        $.ajax({
          url: '/getTotalSupply',
          type: 'GET'
        }).done(function (data) {

          $("#totToken").text(data);
        });

        $.ajax({
          url: '/getBalance',
          data: {
            tgtAccountIdx: "1"
          }, // HTTP 요청과 함께 서버로 보낼 데이터
          type: 'GET'
        }).done(function (data) {
          $("#yourToken").text(data);
        });
    });

    //창 닫기 (메인화면으로)
    function closePop() {
      //parent.$('#popupcontent').hide();        
      parent.location.href = "../index.html";
    }

    //상단 테마 바꾸기
    function changeTheme(theme) {
      $("#ui_theme").attr("href", "../../lib/jui/css/ui-" + theme + ".min.css");
      $("#grid_theme").attr("href", "../../lib/jui/css/grid-" + theme + ".min.css");
      $("#index_theme").attr("href", "../../gallery/admintool/index-" + theme + ".css");

      for (var i = 0, len = chart_list.length; i < len; i++) {

        if (chart_list[i].setTheme) {
          chart_list[i].setTheme(theme);
        } else {
          chart_list[i].chart.setTheme(theme);
        }
      }
    }

    $("#btn_inq").on("click", function (e) {
      var url = '/getSafe182';
      var params = '';

      // 검색조건 GET 방식으로 추가 필요
      if(!$('#writngTrgetDscds010').is(':checked') ||
         !$('#writngTrgetDscds020').is(':checked') ||
         !$('#writngTrgetDscds040').is(':checked') ||
         !$('#writngTrgetDscds060').is(':checked') ||
         !$('#writngTrgetDscds070').is(':checked') ||
         !$('#writngTrgetDscds080').is(':checked')
      ) {
        if($('#writngTrgetDscds010').is(':checked')) {
          params += '&writngTrgetDscds=010';
        }
        if($('#writngTrgetDscds020').is(':checked')) {
          params += '&writngTrgetDscds=020';
        }
        if($('#writngTrgetDscds040').is(':checked')) {
          params += '&writngTrgetDscds=040';
        }
        if($('#writngTrgetDscds060').is(':checked')) {
          params += '&writngTrgetDscds=060';
        }
        if($('#writngTrgetDscds070').is(':checked')) {
          params += '&writngTrgetDscds=070';
        }
        if($('#writngTrgetDscds080').is(':checked')) {
          params += '&writngTrgetDscds=080';
        }
      }

      if('0' != $(":input:radio[name=sexdstnDscd]:checked").val()) {
        params += '&sexdstnDscd=';
        params += $(":input:radio[name=sexdstnDscd]:checked").val();
      }

      if('' != $('#nm').val()) {
        params += '&nm=';
        params += $('#nm').val();
      }

      if('' != $('#detailDate1').val()) {
        params += '&detailDate1=';
        params += $('#detailDate1').val();
      }

      if('' != $('#detailDate2').val()) {
        params += '&detailDate2=';
        params += $('#detailDate2').val();
      }

      if('' != $('#age1').val()) {
        params += '&age1=';
        params += $('#age1').val();
      }

      if('' != $('#age2').val()) {
        params += '&age2=';
        params += $('#age2').val();
      }

      if('' != $('#etcSpfeatr').val()) {
        params += '&etcSpfeatr=';
        params += $('#etcSpfeatr').val();
      }

      if('' != $('#occrAdres').val()) {
        params += '&occrAdres=';
        params += $('#occrAdres').val();
      }

      if('&' == params.charAt(0)) {
        params = '?' + params.substr(1);
      }

      $.get(url+params, function (response) {
        getList(response);
      });
    });

    function getList(data) {
      $('#list_table').empty();

      var resultStr = data;
      var jsonObject = jQuery.parseJSON(resultStr.replace(/\s/g, "<br />"));

      var _result = jsonObject.result;
      var _msg = jsonObject.msg;
      var _totalCount = jsonObject.totalCount;
      var _list = jsonObject.list;

      var content = '';

      content += '<table class="table classic hover">';
      // content += '  <colgroup>';
      // content += '    <col width="10%">';
      // content += '    <col width="20%">';
      // content += '    <col width="6%">';
      // content += '    <col width="18%">';
      // content += '    <col width="31%">';
      // content += '    <col width="10%">';
      // content += '  </colgroup>';

      content += '  <thead>';
      content += '    <tr>';
      content += '      <th style="text-align:center">발생일시</th>';
      content += '      <th style="text-align:center">착의사항</th>';
      content += '      <th style="text-align:center">현재나이</th>';
      content += '      <th style="text-align:center">당시나이</th>';
      content += '      <th style="text-align:center">대상구분</th>';
      content += '      <th style="text-align:center">성별</th>';
      content += '      <th style="text-align:center">특이사항</th>';
      content += '      <th style="text-align:center">발생장소</th>';
      content += '      <th style="text-align:center">성명</th>';
      content += '      <th style="text-align:center">사진</th>';
      content += '    </tr>';
      content += '  </thead>';

      content += '  <tbody>';
      if (_list.length < 1) {
        content += '<tr><td style="text-align:center" colspan=10>조회 결과가 없습니다.</td></tr>';
      } else {
        for (var i = 0; i < _list.length; i++) {
          var writngTrgetDscd = '';
          switch (_list[i].writngTrgetDscd) {
            case "010":
              writngTrgetDscd = "정상아동(18세미만)";
              break;
            case "020":
              writngTrgetDscd = "가출인";
              break;
            case "040":
              writngTrgetDscd = "시설보호무연고자";
              break;
            case "060":
              writngTrgetDscd = "지적장애인";
              break;
            case "061":
              writngTrgetDscd = "지적장애인(18세미만)";
              break;
            case "062":
              writngTrgetDscd = "지적장애인(18세이상)";
              break;
            case "070":
              writngTrgetDscd = "치매질환자";
              break;
            case "080":
              writngTrgetDscd = "불상(기타)";
              break;
          }
          var etcSpfeatr = _list[i].etcSpfeatr.replace(/(<br>|<br\/>|<br \/>)/g, ' ').replace('</td>', '');

          content += '<tr>';
          content += '<td style="text-align:center">' + _list[i].occrde + '</td>'
          content += '<td style="text-align:center">' + (null == _list[i].alldressingDscd ? '' : _list[i]
            .alldressingDscd) + '</td>'
          content += '<td style="text-align:center">' + _list[i].ageNow + '</td>'
          content += '<td style="text-align:center">' + _list[i].age + '</td>'
          content += '<td style="text-align:center">' + writngTrgetDscd + '</td>'
          content += '<td style="text-align:center">' + _list[i].sexdstnDscd + '</td>'
          content += '<td style="text-align:center" title="' + etcSpfeatr + '">' + etcSpfeatr.substring(0, 20) + (
            etcSpfeatr.length > 20 ? '...' : '') + '</td>'
          content += '<td style="text-align:center">' + _list[i].occrAdres + '</td>'
          content += '<td style="text-align:center">' + _list[i].nm + '</td>'

          if (_list[i].tknphotolength != "0") {
            content +=
              "<td style='text-align:center'><img style='width:96px;height:128px;' width='96' height='128' border='0' src='http://www.safe182.go.kr/api/lcm/imgView.do?msspsnIdntfccd=" +
              _list[i].msspsnIdntfccd + "'/></td>";
          } else {
            content += '<td style="text-align:center">&nbsp</td>'
          }
          content += '</tr>';
        }
      }
      content += '  </tbody>';
      content += '</table>';

      $('#list_table').append(content);
    }
  </script>
</body>

</html>