<!DOCTYPE HTML>
<html>

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="initial-scale=1, maximum-scale=1">

  <link rel="stylesheet" href="../../lib/jui/css/ui.min.css" />
  <link id="ui_theme" rel="stylesheet" href="../../lib/jui/css/ui-jennifer.min.css" />
  <link rel="stylesheet" href="../../lib/jui/css/grid.min.css" />
  <link id="grid_theme" rel="stylesheet" href="../../lib/jui/css/grid-jennifer.min.css" />
  <script src="../../lib/jquery-1.8.0.min.js"></script>
  <script src="../../lib/jui/js/core.min.js"></script>
  <script src="../../lib/jui/js/ui.min.js"></script>
  <script src="../../lib/jui/js/grid.min.js"></script>
  <script src="../../lib/jui/js/chart.min.js"></script>
  <link href="http://fonts.googleapis.com/css?family=Open+Sans" rel="stylesheet" type="text/css">
  <link href="../../gallery/admintool/index.css" rel="stylesheet" type="text/css" />
  <link id="index_theme" href="../../gallery/admintool/index-jennifer.css" rel="stylesheet" type="text/css" />
  <style>
    h3 {
      text-align: left;
      margin-left: 20px;
    }

    tr.border_bottom td{
      border-bottom:0.1pt solid rgba(184, 184, 184, 0.849);
    }

    tr.border_bottom th{
      border-bottom:0.1pt solid rgba(184, 184, 184, 0.849);
    }
  </style>
</head>

<body class="jui">

  <div class="header">
    <div class="logo">
      <i class="icon-menu"></i>
    </div>
    <div class="toolbar">
      <span>Theme</span>
      <span>
        <select onchange="changeTheme(this.value)">
          <option value="jennifer">Jennifer</option>
          <option value="dark">Dark</option>
        </select>
      </span>
      <span style="float:right" onclick="closePop()">
        Close
        <i class="icon-check"></i>
      </span>
    </div>
  </div>
  <div class="container">
    <div class="menu">
      <div class="vmenu ">
        <a href="./pop_1.html">
          <i class="icon-more"></i>사전 정보<BR>등록</a>
        <a href="./pop_2.html">
          <i class="icon-bell"></i> 긴급 실종<br>신고</a>
        <a href="./pop_3.html">
          <i class="icon-profile"></i>경찰청 DB<br>조회</a>
        <a href="./pop_4.html">
          <i class="icon-search"></i> 실종/보호<br>아동조회</a>
        <a href="./pop_5.html">
          <i class="icon-add-dir"></i>실종/보호<br>아동등록</a>
        <a href="./pop_6.html" class="active">
          <i class="icon-unhappy" ></i>Market</a>
        <a href="./pop_7.html">
          <i class="icon-user"></i> My Page</a>
        <a href="./pop_8.html">
          <i class="icon-gear"></i> Admin </a>
      </div>
    </div>
    <div class="content">
      <div class="content-list">
        <div class="dashboard-first">
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Today's visitors</div>
              <div class="value">3,352</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Total registration</div>
              <div class="value" id="totRegChain" name="totRegChain">364,806</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Current Issued Token</div>
              <div class="value" id="totToken" name="totToken">15,610</div>
            </div>
          </div>
          <div class="col col-3">
            <div class="card">
              <div class="title" style="color:#808080;">Your Token</div>
              <div class="value" id="yourToken" name="yourToken">1,250</div>
            </div>
          </div>
        </div>

        <div class="panel">
          <div class="body">
            <h2 class="title" align='center' style="margin-left:0px; font-size:35px;margin-bottom:0px;margin-top:25px;"><img src="./icons/bell.png" style="height:30px"> Market</h2>
          </div>
        </div>

        <div class="panel dashed">
          <div class="body" align="center">
            <TABLE class="table_search2 margin_t8 float_l" style="WIDTH: 613px; border-collapse:collapse;" summary="보험상품 정보" sizcache="5" sizset="98">
              <COLGROUP>
                <COL width="33%">
                <COL width="34%">
                <COL width="33%">
              </COLGROUP>
              <TBODY sizcache="5" sizset="98">
                  <TR style="border-bottom:5px" class="border_bottom" align="center">
                  <TD colspan=3>
                    보유하신 포인트로 상품을 구매하실 수 있습니다.<br><br>
                    <!-- BKMH 보유포인트랑 실제 포인트 출력부를 한줄로 부탁합니다 -->
                    <b style="font-size:16px">보유 포인트 : <label style="color:#814fd5"><span id="balance" name="balance">1,250 P</span></label></b><br><br>
                  </TD>
                  <!-- BKMH 상품을 6개 넣었는데, 실제로 가격하고 ID만 다르고 같은 기능이라 반복적으로 스크립트가 구성되지 않도록 -->
                  <!-- BKMH 색조가 많지 않아서, 해당 부분에 금액하고 상품명이 강조되게 부탁드립니다. -->
                  <TR style="border-bottom:5px" class="border_bottom" align="center">
                  <TD>
                      <div>
                            <label><B>XX화재 어린이보험</B></label><br>
                            <img src="./imgInsurance1.jpg" alt="어린이 보험1" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice1" name="MerchantPrice1" value="250" />
                            <input type="hidden" id="MerchantId1" name="MerchantId1" value="1" />
                            250 P<br>                    
                      </div>
                      <button class="btn focus" id="purchase_button1" name="purchase_button1">구매</button>
                      <br>&nbsp;
                  </TD>
                  <TD>
                      <div>
                            <label><B>○○○ 기저귀(남, 대형) - 72p</B></label><br>
                            <img src="./imgDiaper1.jpg" alt="기저귀1" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice2" name="MerchantPrice2" value="140" />
                            <input type="hidden" id="MerchantId2" name="MerchantId2" value="2" />
                            140 P<br>                    
                      </div>
                      <button class="btn focus" id="purchase_button2" name="purchase_button2">구매</button>
                      <br>&nbsp;
                  </TD>
                  <TD>
                      <div>
                            <label><B>△△ 분유(5단계)</B></label><br>
                            <img src="./imgInfantFomula1.jpg" alt="분유1" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice3" name="MerchantPrice3" value="50" />
                            <input type="hidden" id="MerchantId3" name="MerchantId3" value="3" />
                            50 P<br>                    
                      </div>
                      <button class="btn focus" id="purchase_button3" name="purchase_button3">구매</button>
                      <br>&nbsp;
                  </TD>
                  <TR style="border-bottom:5px" class="border_bottom" align="center">                  
                  <TD>
                      <div>
                            <label><B>□□□□ 기저귀(남, 중형) - 80p</B></label><br>
                            <img src="./imgDiaper2.jpg" alt="기저귀2" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice4" name="MerchantPrice4" value="130" />
                            <input type="hidden" id="MerchantId4" name="MerchantId4" value="4" />
                            130 P<br>                   
                      </div>
                      <button class="btn focus" id="purchase_button4" name="purchase_button4">구매</button>
                      <br>&nbsp;
                  </TD>
                  <TD>
                      <div>
                            <label><B>☆☆화재 어린이 (암)보험</B></label><br>
                            <img src="./imgInsurance5.jpg" alt="어린이 보험5" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice5" name="MerchantPrice5" value="140" />
                            <input type="hidden" id="MerchantId5" name="MerchantId5" value="5" />
                            140 P<br>                    
                      </div>
                      <button class="btn focus" id="purchase_button5" name="purchase_button5">구매</button>
                      <br>&nbsp;
                  </TD>
                  <TD>
                      <div>
                            <label><B>♡♡ 젖병(3단계)</B></label><br>
                            <img src="./imgFeedingBottle1.jpg" alt="젖병1" width=165 height=128><br>
                            <input type="hidden" id="MerchantPrice6" name="MerchantPrice6" value="15" />
                            <input type="hidden" id="MerchantId6" name="MerchantId6" value="6" />
                            15 P<br>                  
                      </div>
                      <button class="btn focus" id="purchase_button6" name="purchase_button6">구매</button>
                      <br>&nbsp;
                  </TD>                                                                        
              </TBODY>
            </TABLE>
          </div>
        </div>
      </div>
    </div>
  </div>
    <iframe width="0%" height="0%" name="bIfrm" id="bIfrm" src="" hidden="true"></iframe>
    <script>
      $(function () {

        // getBabiesCount 를 호출하고, 해당 결과를 화면에 갱신
        $.ajax({
          url: '/getBabiesCount',
          type: 'GET'
        }).done(function (data) {

          $("#totRegChain").text(data);
        });

        // getTotalSupply router를 호출하고, 해당 결과를 화면에 갱신
        $.ajax({
          url: '/getTotalSupply',
          type: 'GET'
        }).done(function (data) {

          $("#totToken").text(data);

        });

        $.ajax({
          url: '/getBalance',
          data: {
            tgtAccountIdx: "1"
          },
          type: 'GET'
        }).done(function (data) {

          //
          $("#yourToken").text(data);

          // 현재 보유포인트 라인에 대한 값 입력
          $("#balance").text(data + "P");
        });

        // BKMH 이부분을 동적처리를 통해 처리하는 방법이 있는지?
        $("#purchase_button1").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice1').val();
          var merchantId = $('#MerchantId1').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        });

        $("#purchase_button2").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice2').val();
          var merchantId = $('#MerchantId2').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        });

        $("#purchase_button3").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice3').val();
          var merchantId = $('#MerchantId3').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        }); 

        $("#purchase_button4").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice4').val();
          var merchantId = $('#MerchantId4').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        });  

        $("#purchase_button5").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice5').val();
          var merchantId = $('#MerchantId5').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        }); 

        $("#purchase_button6").on("click", function (e) {

          var merchantPrice = $('#MerchantPrice6').val();
          var merchantId = $('#MerchantId6').val(); // 임시 ID

          buyMerchandise(merchantId, merchantPrice);

        });                              

      });

      // 구매버튼 EVENT
      function buyMerchandise(id, price) {
        $.ajax({
            url: '/purchaseMerchandise',
            type: 'POST',
            data: {
              "merchandisePrice": price, 
              "merchandiseId" : id 
            }
          }).done(function (data) {
            alert("구매가 완료되었습니다.");

          });
      };



      //창 닫기 (메인화면으로)
      function closePop() {
        //parent.$('#popupcontent').hide();
        parent.location.href = "../index.html";
      }

      //상단 테마 바꾸기
      function changeTheme(theme) {
        $("#ui_theme").attr("href", "../../lib/jui/css/ui-" + theme + ".min.css");
        $("#grid_theme").attr("href", "../../lib/jui/css/grid-" + theme + ".min.css");
        $("#index_theme").attr("href", "../../gallery/admintool/index-" + theme + ".css");

        for (var i = 0, len = chart_list.length; i < len; i++) {

          if (chart_list[i].setTheme) {
            chart_list[i].setTheme(theme);
          } else {
            chart_list[i].chart.setTheme(theme);
          }
        }
      }
    </script>
</body>
</html>